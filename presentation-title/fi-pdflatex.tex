%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% I, the copyright holder of this work, release this work into the
%% public domain. This applies worldwide. In some countries this may
%% not be legally possible; if so: I grant anyone the right to use
%% this work for any purpose, without any conditions, unless such
%% conditions are required by law.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass{beamer}
\usetheme[faculty=fi]{fibeamer}
\usepackage[utf8]{inputenc}
\usepackage[
  main=english, %% By using `czech` or `slovak` as the main locale
                %% instead of `english`, you can typeset the
                %% presentation in either Czech or Slovak,
                %% respectively.
  czech, slovak %% The additional keys allow foreign texts to be
]{babel}        %% typeset as follows:
%%
%%   \begin{otherlanguage}{czech}   ... \end{otherlanguage}
%%   \begin{otherlanguage}{slovak}  ... \end{otherlanguage}
%%
%% These macros specify information about the presentation
\title{Introduction to Manifold Learning} %% that will be typeset on the
\subtitle{A Geometry View on Machine Learning} %% title page.
\author{Xiaoyu Xue}
%% These additional packages are used within the document:
\usepackage{ragged2e}  % `\justifying` text
\usepackage{booktabs}  % Tables
\usepackage{tabularx}
\usepackage{tikz}      % Diagrams
\usetikzlibrary{calc, shapes, backgrounds}
\usepackage{amsmath, amssymb}
\usepackage{url}       % `\url`s
\usepackage{listings}  % Code listings
\newcommand{\bol}[1]{\textbf{#1}}
\frenchspacing
\begin{document}
  \frame{\maketitle}

  \AtBeginSection[]{% Print an outline at the beginning of sections
    \begin{frame}<beamer>
      \frametitle{Outline for Section \thesection}
      \tableofcontents[currentsection]
    \end{frame}}

  \begin{darkframes}
    \section{Manifold}
    
    \begin{frame}{Manifold Learning}
    \begin{itemize}
    	\item The data space may not be a Euclidean space, but a nonlinear manifold
    	\item Unfold a manifold, and preserve the geometry structure.
    	\item Euclidean distance $\Longrightarrow$ geodesic distance
    \end{itemize}
	\begin{figure}
	\centering
	\includegraphics[scale=0.2]{./figs/fig1.eps}
	\end{figure}
    \end{frame}

    \begin{frame}{Manifold Learning}
    Find a Euclidean embedding, and then perform traditional learning algorithms in the Euclidean space.
	\begin{block}{Definition of Manifold Learning}
	Given data points $\bol{x}_1, \ldots, \bol{x}_m \in \mathcal{M} \subset \mathbb{R}^n$, try to find a map $f : \mathcal{M} \to \mathbb{R}^d, d\ll n$, where $f = (f_1, \ldots, f_n), f_i : \mathcal{M} \to \mathbb{R}$
	\end{block}
 	\begin{itemize}
 		\item The manifold is unknown! We have only samples!
		\item How to compute the distance on $\mathcal{M}$?
		\item How to find the mapping function $f$
 	\end{itemize}
    \end{frame}

	\begin{frame}{Manifold of Face Images}
	\begin{figure}
	\centering
	\includegraphics[scale=0.28]{./figs/fig4.eps}
	\end{figure}
	
	\end{frame}
	
	\begin{frame}{Manifold of Handwritten Digits}
	\begin{figure}
	\centering
	\includegraphics[scale=0.26]{./figs/fig5.eps}
	\end{figure}
	
	\end{frame}	
	
    \section{Manifold based Dimensionality Reduction}
    \begin{frame}{PCA: Traditional Dimensionality Reduction Method}
    Principal Component Analysis using linear projection to project data to some directions which have maximum variances
  	\begin{eqnarray*}
  		\bol{p}_{opt} & = & \arg\max_{\bol{p}}\sum_{i = 1}^m(y_i - \bar{y})^2\\
  							& = & \arg\max_{\bol{p}}\bol{p}^TC\bol{p}\\
  							&    &  s.t. \bol{p}^T\bol{p} = 1
  	\end{eqnarray*}
  	\begin{itemize}
  		\item If the manifold is linear, PCA can find the optimal result
  		\item PCA can not process nonlinear manifold
  	\end{itemize}
    \end{frame}
    
    \begin{frame}{MDS and ISOMAP}
    \alert{Multidimensional scaling} tries to preserve the Euclidean distances
    \begin{displaymath}
	\Delta :=
	\left( \begin{array}{cccc}
	\delta_{1,1} & \delta_{1,2} & \ldots & \delta_{1,m} \\
	\delta_{2,1} & \delta_{2,2} & \ldots & \delta_{2,m}\\
	\vdots & \vdots & &\vdots\\
	\delta_{m,1} & \delta_{m,2} &\ldots & \delta{m,m}\\
	\end{array} \right)
   \end{displaymath}
   The $\delta$ is the Euclidean distance of every two points $ \delta_{ij}=\Vert \textbf{x}_i - \textbf{x}_j \Vert$ 
   \[
     \min_{\textbf{y}_1,\ldots,\textbf{y}_m} \sum_{i<j}\left(\Vert \textbf{y}_i - \textbf{y}_j \Vert - 
     \delta_{i,j}\right)^2,\quad \textrm{dim}(\textbf{y}_i) \ll \textrm{dim}(\textbf{x}_i)
   \]
    \end{frame}
   
   
   
    \begin{frame}{MDS and ISOMAP}
     \alert{ISOMAP} tries to keep the geodesic distances instead of the Euclidean distances.
    \begin{itemize}
    	\item How to evaluate the geodesic distances with limited samples?
    	\item Construct the adjacency Graph, and calculate the shortest distances (Dijstra or Floyd algorithm)
    \end{itemize}
   	
   	\begin{figure}
   	\centering
   	\includegraphics[scale=0.2]{./figs/fig6.eps}
   	\end{figure}
	   
    \end{frame}
    
    \begin{frame}{Local Linear Embedding}
    \alert{Local Linear Embedding}(2000 Science) is another famous manifold learning method. It tries to preserve the local linear relationship.
    \begin{figure}
    \centering
    \includegraphics[scale=0.2]{./figs/fig7.eps}
    \end{figure}
    \vspace{-5mm}
     \begin{eqnarray*}
    	\min\epsilon(W) & = & \min\sum_i\Vert \bol{x}_i - \sum_jW_{ij}\bol{x}_j \Vert \\
    							 &     & s.t. \sum_j W_{ij} = 1
    \end{eqnarray*}
    \end{frame}
    
    \begin{frame}{Local Linear Embedding}
    \alert{Local Linear Embedding}(2000 Science) is another famous manifold learning method. It tries to preserve the local linear relationship.
    \begin{figure}
    \centering
    \includegraphics[scale=0.15]{./figs/fig8.eps}
    \end{figure}
	\begin{displaymath}
	\min\Phi(\bol{y}) = \min\sum_i\Vert \bol{y}_i - \sum_jW_{ij}\bol{y}_j  \Vert^2
	\end{displaymath}
    \end{frame}
    
    \begin{frame}{Laplace Eigen Map}
    In Laplace Eigen Map, a conclusion has been proofed: \\
    \begin{displaymath}
    	\vert f(\bol{z} ) - f(\bol{x})\vert < \Vert \nabla f(\bol{x}) \Vert\cdot \Vert \bol{z} - \bol{x} \Vert + o(\Vert \bol{z} - \bol{x} \Vert)
    \end{displaymath}
    \begin{itemize}
    \item If $\bol{x}_i$ and $\bol{x}_j$ are close to each other and the gradient of map $f$ is small, we can sure that $f(\bol{x}_i)$ and $f(\bol{x}_j)$ preserve local structure.
    \end{itemize}
    Construct Laplace matrix and get object function
    \begin{displaymath}
    	L\bol{y} = \lambda\bol{y}
    \end{displaymath}
    \end{frame}
    
	\begin{frame}{Global vs Local}
	\begin{itemize}
		\item Global method : ISOMAP
		\item Local method : LLE, LE
		\item Global method can keep more informations of data
		\item But the amount of computation of Global methods is huge
	\end{itemize}
	\end{frame}	    
    
    
    \begin{frame}[label=simmonshall]{Text blocks}
      \framesubtitle{In plain, example, and \alert{alert} flavour}
      \alert{This text} is highlighted.

      \begin{block}{A plain block}
        This is a plain block containing some \alert{highlighted text}.
      \end{block}
      \begin{exampleblock}{An example block}
        This is an example block containing some \alert{highlighted text}.
      \end{exampleblock}
      \begin{alertblock}{An alert block}
        This is an alert block containing some \alert{highlighted text}.
      \end{alertblock}
    \end{frame}

    \begin{frame}[label=proof]{Definitions, theorems, and proofs}
      \framesubtitle{All integers divide zero}
      \begin{definition}
        $\forall a,b\in\mathds{Z}: a\mid b\iff\exists c\in\mathds{Z}:a\cdot c=b$
      \end{definition}
      \begin{theorem}
        $\forall a\in\mathds{Z}: a\mid 0$
      \end{theorem}
      \begin{proof}[Proof\nopunct]
        $\forall a\in\mathds{Z}: a\cdot 0=0$
      \end{proof}
    \end{frame}

    \subsection{Numerals and Mathematics}
    \begin{frame}[label=math]{Numerals and Mathematics}
      \framesubtitle{Formulae, equations, and expressions}
      \begin{columns}[onlytextwidth]
        \column{.20\textwidth}
          1234567890
        \column{.20\textwidth}
          \oldstylenums{1234567890}
        \column{.20\textwidth}
          $\hat{x}$, $\check{x}$, $\tilde{a}$,
          $\bar{a}$, $\dot{y}$, $\ddot{y}$
        \column{.40\textwidth}
          $\int \!\! \int f(x,y,z)\,\mathsf{d}x\mathsf{d}y\mathsf{d}z$
      \end{columns}
      \begin{columns}[onlytextwidth]
        \column{.5\textwidth}
          $$\frac{1}{\displaystyle 1+
            \frac{1}{\displaystyle 2+
            \frac{1}{\displaystyle 3+x}}} +
            \frac{1}{1+\frac{1}{2+\frac{1}{3+x}}}$$
        \column{.5\textwidth}
          $$F:\left| \begin{array}{ccc}
          F''_{xx} & F''_{xy} &  F'_x \\
          F''_{yx} & F''_{yy} &  F'_y \\
          F'_x     & F'_y     & 0
          \end{array}\right| = 0$$
      \end{columns}
      \begin{columns}[onlytextwidth]
        \column{.3\textwidth}
          $$\mathop{\int \!\!\! \int}_{\mathbf{x} \in \mathds{R}^2}
          \! \langle \mathbf{x},\mathbf{y}\rangle\,\mathsf{d}\mathbf{x}$$
        \column{.33\textwidth}
          $$\overline{\overline{a\alpha}^2+\underline{b\beta}
           +\overline{\overline{d\delta}}}$$
        \column{.37\textwidth}
          $\left] 0,1\right[ + \lceil x \rfloor - \langle x,y\rangle$
      \end{columns}
      \begin{columns}[onlytextwidth]
        \column{.4\textwidth}
          \begin{eqnarray*}
           e^x &\approx& 1+x+x^2/2! + \\
             && {}+x^3/3! + x^4/4!
          \end{eqnarray*}
        \column{.6\textwidth}
          $${n+1\choose k} = {n\choose k} + {n \choose k-1}$$
      \end{columns}
    \end{frame}

    \subsection{Figures and Code Listings}
    \begin{frame}[label=figs1]{Figures}
      \framesubtitle{Tables, graphs, and images}
      \begin{table}[!b]
        {\carlitoTLF % Use monospaced lining figures
        \begin{tabularx}{\textwidth}{Xrrr}
          \textbf{Faculty} & \textbf{With \TeX} & \textbf{Total} &
          \textbf{\%} \\
          \toprule
          Faculty of Informatics       & 1\,716  & 2\,904  &
          59.09 \\% 1433
          Faculty of Science           & 786     & 5\,275  &
          14.90 \\% 1431
          Faculty of $\genfrac{}{}{0pt}{}{\textsf{Economics and}}{%
          \textsf{Administration}}$    & 64      & 4\,591  &
          1.39  \\% 1456
          Faculty of Arts              & 69      & 10\,000 &
          0.69  \\% 1421
          Faculty of Medicine          & 8       & 2\,014  &
          0.40  \\% 1411
          Faculty of Law               & 15      & 4\,824  &
          0.31  \\% 1422
          Faculty of Education         & 19      & 8\,219  &
          0.23  \\% 1441
          Faculty of Social Studies    & 12      & 5\,599  &
          0.21  \\% 1423
          Faculty of Sports Studies    & 3       & 2\,062  &
          0.15  \\% 1451
          \bottomrule
        \end{tabularx}}
        \caption{The distribution of theses written using \TeX\ during 2010--15 at MU}
      \end{table}
    \end{frame}
    \begin{frame}[label=figs2]{Figures}
      \framesubtitle{Tables, graphs, and images}
      \begin{figure}[b]
        \centering
        % Flipping a coin
        % Author: cis
        \tikzset{
          head/.style = {fill = none, label = center:\textsf{H}},
          tail/.style = {fill = none, label = center:\textsf{T}}}
        \scalebox{0.65}{\begin{tikzpicture}[
            scale = 1.5, transform shape, thick,
            every node/.style = {draw, circle, minimum size = 10mm},
            grow = down,  % alignment of characters
            level 1/.style = {sibling distance=3cm},
            level 2/.style = {sibling distance=4cm},
            level 3/.style = {sibling distance=2cm},
            level distance = 1.25cm
          ]
          \node[shape = rectangle,
            minimum width = 6cm, font = \sffamily] {Coin flipping}
          child { node[shape = circle split, draw, line width = 1pt,
                  minimum size = 10mm, inner sep = 0mm, rotate = 30] (Start)
                  { \rotatebox{-30}{H} \nodepart{lower} \rotatebox{-30}{T}}
           child {   node [head] (A) {}
             child { node [head] (B) {}}
             child { node [tail] (C) {}}
           }
           child {   node [tail] (D) {}
             child { node [head] (E) {}}
             child { node [tail] (F) {}}
           }
          };

          % Filling the root (Start)
          \begin{scope}[on background layer, rotate=30]
            \fill[head] (Start.base) ([xshift = 0mm]Start.east) arc (0:180:5mm)
              -- cycle;
            \fill[tail] (Start.base) ([xshift = 0pt]Start.west) arc (180:360:5mm)
              -- cycle;
          \end{scope}

          % Labels
          \begin{scope}[nodes = {draw = none}]
            \path (Start) -- (A) node [near start, left]  {$0.5$};
            \path (A)     -- (B) node [near start, left]  {$0.5$};
            \path (A)     -- (C) node [near start, right] {$0.5$};
            \path (Start) -- (D) node [near start, right] {$0.5$};
            \path (D)     -- (E) node [near start, left]  {$0.5$};
            \path (D)     -- (F) node [near start, right] {$0.5$};
            \begin{scope}[nodes = {below = 11pt}]
              \node [name = X] at (B) {$0.25$};
              \node            at (C) {$0.25$};
              \node [name = Y] at (E) {$0.25$};
              \node            at (F) {$0.25$};
            \end{scope}
          \end{scope}
        \end{tikzpicture}}
        \caption{Tree of probabilities -- Flipping a coin\footnote[frame]{%
          A derivative of a diagram from \url{texample.net} by cis, CC BY 2.5 licensed}}
      \end{figure}
    \end{frame}

    \defverbatim[colored]\sleepSort{
      \begin{lstlisting}[language=C,tabsize=2]
  #include <stdio.h>
  #include <unistd.h>
  #include <sys/types.h>
  #include <sys/wait.h>

  // This is a comment
  int main(int argc, char **argv)
  {
          while (--c > 1 && !fork());
          sleep(c = atoi(v[c]));
          printf("%d\n", c);
          wait(0);
          return 0;
  }
    \end{lstlisting}}
    \begin{frame}{Code listings}{An example source code in C}
      \sleepSort
    \end{frame}

    \subsection{Citations and Bibliography}
    \begin{frame}[label=citations]{Citations}
      \framesubtitle{\TeX, \LaTeX, and Beamer}

      \justifying\TeX\ is a programming language for the typesetting
      of documents. It was created by Donald Erwin Knuth in the late
      1970s and it is documented in \emph{The \TeX
      book}~\cite{knuth84}.

      In the early 1980s, Leslie Lamport created the initial version
      of \LaTeX, a high-level language on top of \TeX, which is
      documented in \emph{\LaTeX : A Document Preparation
      System}~\cite{lamport94}. There exists a healthy ecosystem of
      packages that extend the base functionality of \LaTeX;
      \emph{The \LaTeX\ Companion}~\cite{MG94} acts as a guide
      through the ecosystem.

      In 2003, Till Tantau created the initial version of Beamer, a
      \LaTeX\ package for the creation of presentations. Beamer is
      documented in the \emph{User's Guide to the Beamer
      Class}~\cite{tantau04}.
    \end{frame}

    \begin{frame}[label=bibliography]{Bibliography}
      \framesubtitle{\TeX, \LaTeX, and Beamer}
      \begin{thebibliography}{9}
        \bibitem{knuth84}
            Donald~E.~Knuth.
            \emph{The \TeX book}.
            Addison-Wesley, 1984.
        \bibitem{lamport94}
            Leslie~Lamport.
            \emph{\LaTeX : A Document Preparation System}.
            Addison-Wesley, 1986.
        \bibitem{MG94}
            M.~Goossens, F.~Mittelbach, and A.~Samarin.
            \emph{The \LaTeX\ Companion}.
            Addison-Wesley, 1994.
        \bibitem{tantau04}
            Till~Tantau.
            \emph{User's Guide to the Beamer Class Version 3.01}.
            Available at \url{http://latex-beamer.sourceforge.net}.
        \bibitem{MS05}
            A.~Mertz and W.~Slough.
            Edited by B.~Beeton and K.~Berry.
            \emph{Beamer by example} In TUGboat,
              Vol. 26, No. 1., pp. 68-73.
      \end{thebibliography}
    \end{frame}

  

  
    \subsection{Citations and Bibliography}
    \againframe{citations}
    \againframe{bibliography}
    
    \end{darkframes}
\end{document}
